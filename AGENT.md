Changes Needed to Transition Collectives to the New Editor
To switch collective post creation to the new implementation, a number of coordinated changes are required:
Unify the Form Component: Instead of having NewPostForm (for personal) and NewCollectivePostForm separately, we can create a single form component that uses the new structure and handles both cases. This might involve merging the Zod schemas and form logic. In fact, the schemas are already nearly identical – see the definition in NewCollectivePostForm which was “similar to new personal post”
github.com
. We can likely extract a common PostSchema and use it for both. Then, the form UI can simply conditionally show collective context. For instance, it can include a heading like “New Post in [Collective Name]” or a label when a collective is present (the new EditorLayout’s pageTitle prop is used in EditPostForm to show “Edit Post in X”
github.com
; similarly for new we could show “New Post in X”).
Adopt the New EditorLayout Pattern: The biggest front-end change is remodeling the layout. Concretely:
Remove or disable the use of FileExplorer and the left sidebar when in the new editor. The file explorer was intended to show a list of drafts or other posts, but currently in NewPostForm it’s not even populated (the code had personalPosts and collectives arrays TODO for sidebar content
github.com
). Since the dashboard has a dedicated posts list, we might not need an in-editor file list at all. Dropping this will simplify the interface, especially for collective posts (no confusion seeing personal drafts while writing a collective post).
Replace the top PostMetadataBar (which currently houses the Publish button and possibly title input) with the PostFormFields sidebar component. In practice, this means in our JSX we’ll use <EditorLayout settingsSidebar={...} mainContent={...} ...> instead of <EditorLayout sidebar={...} metadataBar={...}>. The PostFormFields includes Title, Status, and Publish Date inputs
github.com
github.com
, which covers what authors need for metadata. We’d also include in that sidebar any extra bits like the “Save Draft” status message and error messages (the current NewPostForm shows autosave and error alerts below the editor; in EditPostForm these were moved into the sidebar below the fields
github.com
github.com
). We should do the same for new-post: e.g., an area in the sidebar that shows “Draft saved” or validation errors.
Provide a way to trigger SEO settings if needed. In the old form, SEOSettingsDrawer is rendered and can slide in on demand
github.com
. In the new design, we might put a button in the sidebar like “SEO Settings” that opens that drawer, or integrate SEO fields directly in the sidebar if desired. This ensures we don’t lose functionality when dropping the old metadata bar (SEO could have been a button there).
Ensure the EditorLayout component is updated to accommodate the new props. It appears the implementation of EditorLayout in the repo might be outdated (only expecting a left sidebar and top bar
github.com
), but given how it’s used with settingsSidebar and mainContent in code, it likely has been enhanced. We’d verify or adjust EditorLayout so that if settingsSidebar is provided, it renders a right column for it. If not already present, we’d add CSS for a two-column layout (e.g., flex with sidebar on left, settingsSidebar on right, or similar). The EditPostForm usage suggests it’s working, so possibly EditorLayout was modified accordingly (maybe via prop spread, or an updated version not fully shown in the snippet).
Carry over the “Posting to collective: Name” indicator. In the new layout, this could simply be part of the page header or a small note in the sidebar. For example, when collectiveName is set in state (as NewCollectivePostForm does by fetching it
github.com
), we can display it at the top of the sidebar: “Collective: [Name]”. This is purely UX sugar, but it’s helpful to confirm context. Alternatively, include the collective name in the page title (e.g., EditorLayout’s pageTitle prop could be set to "New Post in "+collective.name when collective exists).
Routing Decisions: We should decide whether to deprecate the /dashboard/[collectiveId]/new-post route or use it. Since the code for it exists but the UI is not pointing there, we have two sub-options:
Use /posts/new for everything: In this case, we can remove the /dashboard/[collectiveId]/new-post files (NewCollectivePostForm.tsx and its page). The “Add Post” link in collective dashboard can remain as is (pointing to /posts/new?collectiveId=). After refactor, that will still bring users to the new unified editor (just with the query param).
Use the dashboard route for collective: We would change the link to /dashboard/XYZ/new-post and possibly also have to handle navigation after posting. One downside is that the dashboard layout (with side menu) would wrap that page, which might not be what we want for a focused writing experience. (Unless we tweak the dashboard layout to detect an editor sub-route and hide the sidebar, etc., which adds complexity.) Given this, continuing to use the top-level /posts/new route seems preferable. It keeps the editor free of the main dashboard chrome.
Regardless of route chosen, we must eliminate the duplicate implementations. I recommend deleting or merging NewCollectivePostForm to avoid confusion. We can keep maybe some of its code (it has already written the side-panel style logic which we can reuse), but have one source of truth for creating posts.
Permission Alignment: As noted, the front-end currently only allows owners to initiate collective post creation
github.com
, whereas the backend createPost allows any authorized member role
github.com
. As part of this refactor, we should update the front-end checks to match the backend rules (or simply trust the backend). Ideally, when a user who is an editor/author in a collective clicks “Add Post”, we should let them into the editor. So, we might expand the check in /posts/new/page.tsx to allow collective members with roles (we can query collective_members in the server component similar to what postActions.ts does). This way the UI won’t show 404 for a legitimate editor. The TODO in code explicitly mentions this improvement. If we move away from using /posts/new for collective and rely on the dashboard route, note that the dashboard layout already fetched collectives and membership info for the sidebar; we could leverage that or perform a check in the NewCollectivePostPage. In short, one of the changes should be allowing collective editors (not just owners) to access the create form, consistent with RLS policies.
Post-creation Behavior: Currently, after a post is created, the form sets an internal createdPostId state and likely could redirect (though I think the current NewPostForm might not auto-redirect on publish – it seems geared toward auto-saving drafts and staying on the editor). We might want to implement a redirect or a success message when a post is successfully published. For example, once a post is published (status set to published), perhaps navigate the user to the post page or to the collective’s dashboard. The question doesn’t explicitly ask for this, but from a UX perspective, it’s worth considering during the refactor. In any case, that behavior can be shared between personal and collective posts (maybe after publishing a collective post, you go to that collective’s page; after a personal post, go to your newsletter feed).
Testing and Shared Edge Cases: We’ll need to test that toggling between Draft/Publish/Schedule works in the unified form for both contexts. Both types of posts should allow scheduling, and the form fields for that are already in PostFormFields. Also ensure the is_public flag logic remains correct (right now, createPost uses an is_public boolean defaulting true
github.com
– presumably “is_public” corresponds to whether the post is published to everyone or just to subscribers, but in code they treat unpublished drafts similarly for both personal and collective).
Cleaning Up Duplicates: After migrating, we can remove the old PostMetadataBar component if it’s no longer used, and possibly the FileExplorer if it’s not needed. (FileExplorer might still be used elsewhere if they have a file upload or media manager; if not, it can go.)
Architectural and Maintainability Assessment
Unifying the editor for both personal newsletter posts and collective posts is absolutely a sound choice from an architectural standpoint. Here’s why:
Single Source of Truth: Maintaining one code path for creating/editing posts reduces duplication. Currently, we have parallel implementations (the beginnings of one in NewCollectivePostForm and the existing NewPostForm). This duplication can lead to inconsistencies and bugs if one is updated and not the other. A unified editor means any improvement (autosave tweaks, new features like post tags, etc.) can be made in one place and will apply to both post types.
Consistent User Experience: From the user’s perspective, writing a post should feel the same whether it’s going to their personal newsletter or to a collective they contribute to. Right now, if we left it as-is, there might be confusion (imagine if the personal post editor got the new UI but the collective post editor was still the old UI – users would wonder why the editor looks different). Unification ensures that all authors get the benefits of the new editor interface. It also shortens the learning curve: once a user knows how to use the editor, they can use it in any context.
Flexibility for Future Features: The new editor layout (with a sidebar for settings) is more scalable. We can add more fields or options (e.g., selecting which email subscribers to send to, adjusting SEO settings, attaching images, etc.) into the sidebar without cluttering the main content area. This layout is already being used for editing posts and seems to be the forward direction. By moving collectives onto it, we ensure any future enhancements to the editing interface (say, a collaborative editing feature or a preview mode) will be uniformly available. It’s easier to maintain one robust editor than two variants.
No Strong Reason to Keep Them Separate: There doesn’t appear to be a fundamental difference between a “newsletter post” and a “collective post” that would necessitate different editors. Both share the same database table and nearly identical fields. The only minor difference might be in how they’re ultimately distributed (perhaps personal newsletters might email subscribers directly, whereas collectives might have slightly different audience rules), but that doesn’t affect the content creation process – that’s handled after publishing. If anything, if such differences arise, we can handle them with simple conditional UI elements (e.g., a checkbox “email subscribers” which might be applicable in both contexts anyway). Therefore, we have no technical or UX justification to maintain two separate editor systems.
Potential Pitfalls / Considerations: There are a few things to watch out for in this refactor, though none are deal-breakers:
Make sure that any collective-specific logic (like selecting a plan/tier if collectives had paid tiers for content, etc.) is accounted for. Currently, there’s no mention of that, so likely not applicable yet.
Ensure that by removing the old FileExplorer-based layout, we’re not losing needed functionality. If some users liked navigating their drafts in that sidebar, we should ensure the Dashboard “My Posts” page and collective dashboard pages make it easy to find drafts for editing. In other words, ensure there’s a clear flow: Dashboard list → click draft → goes to editor. That seems to be the case (the PostListItem probably links to /posts/[id]/edit).
The unified approach should be thoroughly tested for both scenarios (with and without collectiveId) to catch any conditional bugs (e.g., accidentally not setting collective_id on the payload if we unify incorrectly – but the server action looks after that based on presence of the param).
Overall, refactoring collective post creation to use the new editor implementation is highly beneficial. It improves maintainability by reducing duplicate code and aligns the user experience. I see no reason not to unify the editors. The new system is clearly designed to handle both (the developers already started down that road, as evidenced by the new collective form using the same PostEditor and form fields structure
github.com
). The changes required are straightforward: update the routing (if needed), merge form components, and remove the legacy UI elements. Once done, both collective and personal posts will be created through the same modern interface – which is easier to maintain and extend in the long run.
